---
title: 文件上传
date: 2021-02-24 16:00:22
tags: [node]

---



`文件上传` 功能在web开发中很常见，常见都上传方式有 `form` 、`Ajax` 等，我们主要讲解如何使用 `Ajax` 来进行提交，同时，我们采用原生写法。

为什么用原生写法呢？只要你掌握原生写法，那么不管你用的什么第三方框架，都能写的出来。

后台我们使用 `express` 进行搭建。





---





## 初始化项目

1. 新建一个文件夹 `upload-file`， 然后执行以下命令

```bash
npm init -y
```

或

```bash
yarn init -y
```





2. 在 `upload-file` 下创建以下文件和目录

```
pages
  - index.html
upload
main.js
package.json
```





3. 执行以下命令安装依赖包

```bash
npm i express multer body-parser -S
```

或

```bash
yarn add express multer body-parser
```





**各个依赖包的作用：**

- `express`：搭建服务器
- `body-parser` ：处理请求参数
- `multer` ：处理文件上传



到此，我们的项目就初始化完成了





---





## 基本配置



### HTML配置

打开 `pages/index.html`，在 body 内写入以下内容

```html
<button id="btn">上传</button>

<script>
    // 获取到我们的按钮元素
	let btn = document.getElementById('btn');
</script>
```



我们在 body 标签内写了一个按钮，后续的上传操作，我们都通过点击这个按钮来完成





---





### 入口文件配置

打开我们都 `main.js` ，写入以下内容

```js
const express = require('express')
const bodyParser = require('body-parser')
const path = require('path')
const fs = require('fs')
const multer = require('multer')
const app = express()

// 配置静态资源目录
app.use(express.static(path.resolve(__dirname, 'pages')))

// 配置请求参数解析
app.use(bodyParser.json())
app.use(bodyParser.urlencoded({ extended: false }))

// 服务器监听
app.listen(8080, () => {
    console.log('http://127.0.0.1:8080');
})
```



通过上面的配置，我们的服务器就搭建起来来，我们在 `upload-file` 这个文件夹下，按下键盘都 `shift` + `鼠标右键`, 选择 `在此处打开 powershell` 。

然后，我们去浏览器打开 `http://127.0.0.1:8080` ，就能看到我们的HTML文件了。



